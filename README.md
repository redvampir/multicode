# MultiCode — Визуальное программирование для русскоязычных разработчиков

> **Проект создаётся для русскоязычной аудитории.** Главная цель — дать возможность создавать и работать с визуальными графами на русском языке: русские названия узлов, русские комментарии, полная локализация интерфейса.

---

## Ключевые особенности

### Русский язык — первый класс поддержки
- **Русские названия узлов**: "Начало", "Ветвление", "Цикл For", "Вывод" вместо Start/Branch/ForLoop/Print
- **Русские комментарии в коде**: генерируемый C++ код сохраняет русские названия в комментариях
- **Полная локализация UI**: все элементы интерфейса переведены на русский
- **Переключение RU/EN**: мгновенная смена языка без перезагрузки

### Blueprint-style редактор
Визуальный редактор в стиле Unreal Engine Blueprints:
- Цветовая схема типов данных (как в UE)
- Exec-порты (белые квадраты) для потока выполнения
- Data-порты (цветные круги) для передачи данных
- Drag-and-drop соединение с валидацией типов

---

## Что уже работает

### C++ ядро
- Строгие ID для узлов/портов/соединений (`Types.hpp`)
- `Node`, `Port`, `Graph`, `NodeFactory` с полной валидацией
- Топологическая сортировка, обнаружение циклов, статистика графа
- JSON сериализация с версионированием схемы
- Готовые типы узлов: Start/End/If/Loops/Math/Logic/IO

### VS Code расширение
- **Blueprint редактор** на React Flow — основной режим
- **Classic редактор** на Cytoscape — legacy режим
- Палитра узлов с категориями и поиском (клавиша `A`)
- Локализация RU/EN с мгновенным переключением
- IPC протокол с Zod валидацией

---

## Быстрый старт

### Сборка C++ ядра

```bash
# Windows (рекомендуется для кириллицы)
.\scripts\build-cmake-utf8.ps1

# Или вручную
cmake -S . -B build
cmake --build build
ctest --test-dir build --output-on-failure
```

### Запуск VS Code расширения

```bash
cd vscode-extension
npm install
npm run compile
# F5 в VS Code для запуска Extension Development Host
```

---

## Архитектура

```
MultiCode/
├── include/visprog/core/     # C++ публичные заголовки
│   ├── Types.hpp             # NodeId, PortId, Result<T>
│   ├── Node.hpp              # Узел графа
│   ├── Port.hpp              # Порты узлов
│   ├── Graph.hpp             # Контейнер графа
│   ├── NodeFactory.hpp       # Фабрика узлов
│   └── GraphSerializer.hpp   # JSON сериализация
├── src/core/                 # C++ реализации
├── tests/                    # Catch2 тесты
├── vscode-extension/
│   ├── src/
│   │   ├── extension.ts      # Точка входа
│   │   ├── panel/            # GraphPanel, IPC
│   │   ├── webview/          # React компоненты
│   │   │   ├── BlueprintEditor.tsx  # React Flow редактор
│   │   │   ├── ErrorBoundary.tsx    # Обработка ошибок React
│   │   │   ├── ContextMenu.tsx      # Контекстное меню
│   │   │   ├── PackageManagerPanel.tsx  # Менеджер пакетов
│   │   │   ├── hooks/        # React хуки
│   │   │   │   ├── useUndoRedo.ts    # Undo/Redo с debounce
│   │   │   │   ├── useClipboard.ts   # Copy/Cut/Paste
│   │   │   │   ├── useAutoLayout.ts  # Dagre автолейаут
│   │   │   │   └── usePackageRegistry.ts  # Загрузка пакетов
│   │   │   └── nodes/        # Кастомные узлы React Flow
│   │   ├── codegen/          # Генераторы кода
│   │   └── shared/           # Типы, сообщения, переводы
│   └── dist/                 # Скомпилированные файлы
├── packages/                 # Пакеты узлов
│   └── std/                  # @multicode/std — стандартный пакет
└── Документы/                # Документация на русском
```

---

## Типы узлов

| Категория | Узлы (RU) | Узлы (EN) |
|-----------|-----------|-----------|
| Управление | Начало, Конец, Ветвление, Переключатель | Start, End, Branch, Switch |
| Циклы | Цикл For, Цикл While, Последовательность | ForLoop, WhileLoop, Sequence |
| Переменные | Переменная, Получить, Установить | Variable, Get, Set |
| Математика | Сложение, Вычитание, Умножение, Деление | Add, Subtract, Multiply, Divide |
| Логика | И, Или, Не, Сравнение | And, Or, Not, Compare |
| Ввод/Вывод | Вывод, Ввод | Print, Input |

---

## Новые функции (v0.3.0)

### Blueprint редактор
- **Undo/Redo** — отмена и повтор действий (`Ctrl+Z` / `Ctrl+Y`)
- **Copy/Paste** — копирование узлов с сохранением связей (`Ctrl+C` / `Ctrl+V`)
- **Автолейаут** — автоматическое выравнивание графа (клавиша `L`)
- **Менеджер пакетов** — загрузка и выгрузка пакетов узлов
- **Контекстное меню** — правый клик для быстрых действий
- **ErrorBoundary** — защита от краха UI с отображением ошибок

### Система пакетов
- Пакеты узлов загружаются из JSON (`packages/std/package.json`)
- Возможность создания собственных пакетов с узлами
- Стандартный пакет `@multicode/std` загружается автоматически

---

## Ближайшие задачи

1. **Кодогенерация C++**: генерация кода из визуального графа с русскими комментариями
2. **Улучшение UX**: горячие клавиши, тултипы, подсказки
3. **Сохранение проектов**: интеграция с файловой системой VS Code

---

## Участие в проекте

- Pull Request должен компилироваться и проходить `ctest`
- Новый функционал требует тестов в `tests/core`
- Перед коммитом: `clang-format` для C++, `npm run lint` для TypeScript
- **Документация на русском** — приветствуется

### Форматирование C++

```bash
git ls-files '*.hpp' '*.cpp' | grep -v third_party | xargs clang-format -i
```

---

## Документация

| Документ | Описание |
|----------|----------|
| [AI_AGENTS_GUIDE.md](AI_AGENTS_GUIDE.md) | Руководство для ИИ-агентов |
| [CODING_GUIDELINES.md](CODING_GUIDELINES.md) | Правила кодирования |
| [ROADMAP.md](ROADMAP.md) | План версий |
| [Документы/](Документы/) | Детальная документация |

---

## Лицензия

MIT License. См. [LICENSE](LICENSE).

---

> **MultiCode** — визуальное программирование на русском языке. Создавайте графы, генерируйте код, работайте на родном языке.
